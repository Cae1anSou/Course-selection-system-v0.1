{"ast":null,"code":"var _jsxFileName = \"/Users/caoxinzhuo/Library/Mobile Documents/com~apple~CloudDocs/\\u5927\\u5B66/\\u4EE3\\u7801/cursor/\\u9009\\u8BFE\\u7CFB\\u7EDF1.0/frontend/src/components/course/FileUploadDialog.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport { Dialog, DialogTitle, DialogContent, DialogActions, Button, Box, Typography, Alert, CircularProgress } from '@mui/material';\nimport { CloudUpload as CloudUploadIcon } from '@mui/icons-material';\nimport { courseService } from '../../services/courseService';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst FileUploadDialog = ({\n  open,\n  onClose,\n  onSuccess\n}) => {\n  _s();\n  const [file, setFile] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const handleFileChange = event => {\n    if (event.target.files && event.target.files[0]) {\n      var _selectedFile$name$sp;\n      const selectedFile = event.target.files[0];\n      const fileType = (_selectedFile$name$sp = selectedFile.name.split('.').pop()) === null || _selectedFile$name$sp === void 0 ? void 0 : _selectedFile$name$sp.toLowerCase();\n      if (fileType === 'pdf' || fileType === 'csv') {\n        setFile(selectedFile);\n        setError('');\n      } else {\n        setError('只支持上传 PDF 或 CSV 文件');\n        setFile(null);\n      }\n    }\n  };\n  const handleUpload = async () => {\n    if (!file) {\n      setError('请选择要上传的文件');\n      return;\n    }\n    try {\n      setLoading(true);\n      setError('');\n      const formData = new FormData();\n      formData.append('file', file);\n      await courseService.importCourses(formData);\n      onSuccess();\n      onClose();\n    } catch (err) {\n      var _err$response, _err$response$data;\n      setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.detail) || '文件上传失败');\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(Dialog, {\n    open: open,\n    onClose: onClose,\n    maxWidth: \"sm\",\n    fullWidth: true,\n    children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n      children: \"\\u4E0A\\u4F20\\u8BFE\\u8868\\u6587\\u4EF6\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n      children: /*#__PURE__*/_jsxDEV(Box, {\n        sx: {\n          textAlign: 'center',\n          py: 3\n        },\n        children: [error && /*#__PURE__*/_jsxDEV(Alert, {\n          severity: \"error\",\n          sx: {\n            mb: 2\n          },\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          accept: \".pdf,.csv\",\n          style: {\n            display: 'none'\n          },\n          id: \"file-upload\",\n          type: \"file\",\n          onChange: handleFileChange,\n          disabled: loading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"file-upload\",\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"outlined\",\n            component: \"span\",\n            startIcon: /*#__PURE__*/_jsxDEV(CloudUploadIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 92,\n              columnNumber: 26\n            }, this),\n            disabled: loading,\n            children: \"\\u9009\\u62E9\\u6587\\u4EF6\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 11\n        }, this), file && /*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"body1\",\n          sx: {\n            mt: 2\n          },\n          children: [\"\\u5DF2\\u9009\\u62E9: \", file.name]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 13\n        }, this), loading && /*#__PURE__*/_jsxDEV(Box, {\n          sx: {\n            mt: 2\n          },\n          children: /*#__PURE__*/_jsxDEV(CircularProgress, {\n            size: 24\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        onClick: onClose,\n        disabled: loading,\n        children: \"\\u53D6\\u6D88\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        onClick: handleUpload,\n        variant: \"contained\",\n        disabled: !file || loading,\n        children: \"\\u4E0A\\u4F20\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 5\n  }, this);\n};\n_s(FileUploadDialog, \"6OZMGRgXD5atvo0MkF3ig2ukG4k=\");\n_c = FileUploadDialog;\nexport default FileUploadDialog;\nvar _c;\n$RefreshReg$(_c, \"FileUploadDialog\");","map":{"version":3,"names":["React","useState","Dialog","DialogTitle","DialogContent","DialogActions","Button","Box","Typography","Alert","CircularProgress","CloudUpload","CloudUploadIcon","courseService","jsxDEV","_jsxDEV","FileUploadDialog","open","onClose","onSuccess","_s","file","setFile","loading","setLoading","error","setError","handleFileChange","event","target","files","_selectedFile$name$sp","selectedFile","fileType","name","split","pop","toLowerCase","handleUpload","formData","FormData","append","importCourses","err","_err$response","_err$response$data","response","data","detail","maxWidth","fullWidth","children","fileName","_jsxFileName","lineNumber","columnNumber","sx","textAlign","py","severity","mb","accept","style","display","id","type","onChange","disabled","htmlFor","variant","component","startIcon","mt","size","onClick","_c","$RefreshReg$"],"sources":["/Users/caoxinzhuo/Library/Mobile Documents/com~apple~CloudDocs/大学/代码/cursor/选课系统1.0/frontend/src/components/course/FileUploadDialog.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Button,\n  Box,\n  Typography,\n  Alert,\n  CircularProgress,\n} from '@mui/material';\nimport { CloudUpload as CloudUploadIcon } from '@mui/icons-material';\nimport { courseService } from '../../services/courseService';\n\ninterface FileUploadDialogProps {\n  open: boolean;\n  onClose: () => void;\n  onSuccess: () => void;\n}\n\nconst FileUploadDialog: React.FC<FileUploadDialogProps> = ({\n  open,\n  onClose,\n  onSuccess,\n}) => {\n  const [file, setFile] = useState<File | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  const handleFileChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    if (event.target.files && event.target.files[0]) {\n      const selectedFile = event.target.files[0];\n      const fileType = selectedFile.name.split('.').pop()?.toLowerCase();\n      \n      if (fileType === 'pdf' || fileType === 'csv') {\n        setFile(selectedFile);\n        setError('');\n      } else {\n        setError('只支持上传 PDF 或 CSV 文件');\n        setFile(null);\n      }\n    }\n  };\n\n  const handleUpload = async () => {\n    if (!file) {\n      setError('请选择要上传的文件');\n      return;\n    }\n\n    try {\n      setLoading(true);\n      setError('');\n      \n      const formData = new FormData();\n      formData.append('file', file);\n      \n      await courseService.importCourses(formData);\n      onSuccess();\n      onClose();\n    } catch (err: any) {\n      setError(err.response?.data?.detail || '文件上传失败');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <Dialog open={open} onClose={onClose} maxWidth=\"sm\" fullWidth>\n      <DialogTitle>上传课表文件</DialogTitle>\n      <DialogContent>\n        <Box sx={{ textAlign: 'center', py: 3 }}>\n          {error && (\n            <Alert severity=\"error\" sx={{ mb: 2 }}>\n              {error}\n            </Alert>\n          )}\n          \n          <input\n            accept=\".pdf,.csv\"\n            style={{ display: 'none' }}\n            id=\"file-upload\"\n            type=\"file\"\n            onChange={handleFileChange}\n            disabled={loading}\n          />\n          <label htmlFor=\"file-upload\">\n            <Button\n              variant=\"outlined\"\n              component=\"span\"\n              startIcon={<CloudUploadIcon />}\n              disabled={loading}\n            >\n              选择文件\n            </Button>\n          </label>\n          \n          {file && (\n            <Typography variant=\"body1\" sx={{ mt: 2 }}>\n              已选择: {file.name}\n            </Typography>\n          )}\n          \n          {loading && (\n            <Box sx={{ mt: 2 }}>\n              <CircularProgress size={24} />\n            </Box>\n          )}\n        </Box>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onClose} disabled={loading}>\n          取消\n        </Button>\n        <Button\n          onClick={handleUpload}\n          variant=\"contained\"\n          disabled={!file || loading}\n        >\n          上传\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default FileUploadDialog; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}